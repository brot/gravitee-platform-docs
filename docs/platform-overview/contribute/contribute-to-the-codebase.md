# Contribute to the Codebase

This page describes how you can contribute to Gravitee's codebase:

* [Using GitHub issues](contribute-to-the-codebase.md#using-github-issues)
* [Submitting changes](contribute-to-the-codebase.md#submitting-changes)
* [Updating a forked `gravitee-gateway` repo](contribute-to-the-codebase.md#using-a-fork-of-the-old-gravitee-gateway-repository)
* [Bootstrapping your dev env](contribute-to-the-codebase.md#bootstrapping-your-dev-environment)

## Using GitHub issues

We use GitHub issues to track bugs and enhancements. Found a bug in the source code? Want to propose new features or enhancements? You can help us by submitting an [issue](https://github.com/gravitee-io/gravitee-platform-docs/issues) to our repository. But before you do, please search the issues archive to see if your question has already been answered.

Providing the following information will help us deal with your issue quickly:

* **Overview of the issue:** Describe the issue and why this is a bug for you.
* **Gravitee version(s):** Possible regression??
* **Browsers and operating system:** Linux/Windows/Docker? Browser version for the UI, etc.
* **Stack traces, screenshots, logs??** Add these to the issue’s description.

## Submitting changes

Have you submitted an issue to the project and know how to fix it? You can contribute to the project by [forking the repository](https://docs.github.com/en/get-started/quickstart/contributing-to-projects) and [submitting a pull request](https://docs.github.com/en/get-started/quickstart/contributing-to-projects#making-a-pull-request).

### Before creating a PR

1. Make your changes in a new git branch, where `issue-id` references the ID generated by GitHub:

```sh
git checkout -b issue/<issue-id>-my-fix-branch master
```

2. Create your patch, **including appropriate test cases**.
3. Update the documentation if you create new features, or if you think the documentation needs to be updated/completed.
4. Commit your changes using a descriptive [Conventional Commit Message](https://www.conventionalcommits.org/en/v1.0.0/):

```sh
git commit -a -m "feat: this is an example"
```

5. Build your changes locally to **ensure all the tests pass**:

```sh
mvn clean install
```

### Push your branch to GitHub

1. Run the following command:

```sh
git push origin issue/<issue-id>-my-fix-branch
```

2. In GitHub, send a pull request to the master branch, e.g., `<gravitee-io/gravitee-api-management>:master`.
3. If we suggest changes:
   1. Make the required updates.
   2. Re-run the test suite to ensure tests are still passing.
   3. Commit your changes to your branch (e.g., `issue/<issue-id>-my-fix-branch`).
   4. Push the changes to your GitHub repository (this will update your pull request).
4. If the PR becomes outdated, we may ask you to rebase and force push to update the PR:

```sh
git rebase master
git push origin issue/<issue-id>-my-fix-branch -f
```

That’s it! You’ve just contributed to the project, and we really appreciate it!

{% hint style="info" %}
You can find more detailed information about contributing in the [Github guides](https://docs.github.com/en)
{% endhint %}

## Using a fork of the old `gravitee-gateway` repository?

If you have a fork of `gravitee-gateway`, you can update it to get the full API Management monorepo:

```sh
# Add APIM monorepo remote
git remote add upstream https://github.com/gravitee-io/gravitee-api-management
git fetch --all

# Update repo branches, et voilà
git pull upstream BASE_BRANCH

# Update the branch you are working on
# git checkout YOUR_BRANCH
# git rebase BASE_BRANCH

# Push the updated branch
git push origin YOUR_BRANCH
```

## Bootstrapping your dev environment

This section describes how to configure your environment to contribute to Gravitee APIM. When generalized, it can function as a loose template for contributions to other projects.

### Prerequisites

You will need the following tools installed on your computer:

* Java (JDK >= 11)
* Maven
* Docker
* NPM (preferably NVM)

### Get the project and prepare your workspace

1. Clone the project in your workspace:

```sh
git clone https://github.com/gravitee-io/gravitee-api-management
```

2. Build APIM Management API and Gateway

```sh
mvn clean install -T 2C
```

{% hint style="info" %}
You can use `-Dskip.validation=true` to skip license validation and prettier checks.

This command will create a `distribution` folder in the `target` folder of each module. These folders contain a full distribution of Management API and Gateway, with default plugins. The `distribution` folder should be used as the `gravitee.home` environment variable.
{% endhint %}

3. Prepare APIM Console UI and Portal UI
4. Run `npm install` from the `gravitee-api-management/gravitee-apim-console-webui` and `gravitee-api-management/gravitee-apim-portal-webui` directories.

{% hint style="info" %}
You can run `nvm use` to switch to the appropriate version of NPM to build the UIs
{% endhint %}

### Run Prerequisites

Before starting APIM Management API and Gateway, you need to start MongoDB and ElasticSearch. This can be done with docker.

{% tabs %}
{% tab title="MongoDB" %}
```sh
docker run -p 27017:27017 --name local-mongo -d mongo:6
```
{% endtab %}

{% tab title="ElasticSearch" %}
```sh
docker run -d --name local-es7 -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" docker.elastic.co/elasticsearch/elasticsearch:7.17.10
```
{% endtab %}
{% endtabs %}

### Run Configuration

{% hint style="info" %}
`${GRAVITEE_HOME}` refers to the target/distribution folder created before
{% endhint %}

#### **APIM Gateway (gravitee-apim-gateway)**

{% tabs %}
{% tab title="CLI method" %}
Run `./gravitee` from the `${GRAVITEE_HOME}/bin` directory
{% endtab %}

{% tab title="IntelliJ configuration" %}
The project includes by default the configuration `Gateway - MongoDB` to run the Gateway
{% endtab %}
{% endtabs %}

#### APIM Management API (gravitee-apim-rest-api)

{% tabs %}
{% tab title="CLI method" %}
Run `./gravitee` from the `${GRAVITEE_HOME}/bin` directory
{% endtab %}

{% tab title="IntelliJ configuration" %}
The project includes by default the configuration `Rest API - MongoDB` to run the Rest API
{% endtab %}
{% endtabs %}

#### APIM Console (gravitee-apim-console-webui)&#x20;

{% tabs %}
{% tab title="CLI method" %}
Run `npm run serve` from the `gravitee-api-management/gravitee-apim-console-webui` directory to start the UI
{% endtab %}

{% tab title="IntelliJ configuration" %}
Create a new Run configuration in IntelliJ:

1. Click **Run → Edit configurations → ✚ → npm**
2. Name it as required
3. Choose **package.json: gravitee-api-management/gravitee-apim-console-webui/package.json**
4. Select **Command: run**
5. Select **Script: serve**

To `npm install`, duplicate this configuration and choose **Command > Install**.
{% endtab %}
{% endtabs %}

#### APIM Portal (gravitee-apim-portal-webui)&#x20;

{% tabs %}
{% tab title="CLI method" %}
Run `npm run serve` from the `gravitee-api-management/gravitee-apim-portal-webui` directory to start the UI
{% endtab %}

{% tab title="IntelliJ configuration" %}
Create a new Run configuration in IntelliJ:

1. Click **Run → Edit configurations → ✚ → npm**
2. Name it as required
3. Choose **package.json: gravitee-api-management/gravitee-apim-portal-webui/package.json**
4. Select **Command: run**
5. Select **Script: serve**

To `npm install`, duplicate this configuration and choose **Command > Install**.
{% endtab %}
{% endtabs %}
